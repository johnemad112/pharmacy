<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Ø§Ù„Ø³Ù„Ø© - ØµÙŠØ¯Ù„ÙŠØ© Ø£ÙˆÙ†Ù„Ø§ÙŠÙ†</title>
  <link rel="stylesheet" href="assets/css/style.css"/>
</head>
<body>
  <header class="container header">
    <div class="brand">
      <a href="index.html" class="logo">ğŸ’Š ØµÙŠØ¯Ù„ÙŠØ© Ø£ÙˆÙ†Ù„Ø§ÙŠÙ†</a>
    </div>
    <nav class="nav">
      <a href="index.html">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
      <a href="cart.html" class="cart-link">Ø§Ù„Ø³Ù„Ø© (<span id="cart-count">0</span>)</a>
    </nav>
  </header>

  <main class="container">
    <h1>Ø§Ù„Ø³Ù„Ø©</h1>
    <div id="cart"></div>
    <div class="checkout card">
      <h3>Ø¥ØªÙ…Ø§Ù… Ø§Ù„Ø·Ù„Ø¨</h3>
      <label>Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„ <input id="name" type="text" required></label>
      <label>Ø§Ù„Ù‡Ø§ØªÙ <input id="phone" type="tel" required></label>
      <label>Ø§Ù„Ø¹Ù†ÙˆØ§Ù† <input id="address" type="text" required></label>
      <label>Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹
        <select id="payment">
          <option value="cod">Ø§Ù„Ø¯ÙØ¹ Ø¹Ù†Ø¯ Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù… (COD)</option>
          <option value="card" disabled>Ø¨Ø·Ø§Ù‚Ø© (Ù‚Ø±ÙŠØ¨Ù‹Ø§)</option>
        </select>
      </label>
      <button id="place">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨</button>
      <p class="note">ØªÙ†Ø¨ÙŠÙ‡: Ø¨Ø¹Ø¶ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ù‚Ø¯ ØªØªØ·Ù„Ø¨ ÙˆØµÙØ© Ø·Ø¨ÙŠØ©. Ø³ÙŠØªÙˆØ§ØµÙ„ Ù…Ø¹Ùƒ Ø§Ù„ØµÙŠØ¯Ù„ÙŠ Ø¹Ù†Ø¯ Ø§Ù„Ø­Ø§Ø¬Ø©.</p>
    </div>
  </main>

  <footer class="container footer">
    <p class="copy">Â© 2025 ØµÙŠØ¯Ù„ÙŠØ© Ø£ÙˆÙ†Ù„Ø§ÙŠÙ†</p>
  </footer>

  <script>
    const fmt = new Intl.NumberFormat('ar-EG', { style: 'currency', currency: 'EGP' });
    function getCart(){return JSON.parse(localStorage.getItem('cart')||'[]')}
    function setCart(c){localStorage.setItem('cart', JSON.stringify(c)); document.getElementById('cart-count').textContent=c.reduce((t,i)=>t+i.qty,0)}
    function render(){
      const wrap = document.getElementById('cart');
      const cart = getCart();
      setCart(cart);
      if(cart.length===0){ wrap.innerHTML = '<p>Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ©.</p>'; return; }
      let html = '<div class="card table"><div class="row head"><div>Ø§Ù„Ù…Ù†ØªØ¬</div><div>Ø§Ù„ÙƒÙ…ÙŠØ©</div><div>Ø§Ù„Ø³Ø¹Ø±</div><div>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</div><div></div></div>';
      let total = 0;
      cart.forEach((it,idx)=>{
        const sub = it.price*it.qty; total += sub;
        html += `<div class="row"><div>${it.title}</div>
        <div class="qty">
          <button data-i="${idx}" data-a="-1">-</button>
          <span>${it.qty}</span>
          <button data-i="${idx}" data-a="1">+</button>
        </div>
        <div>${fmt.format(it.price)}</div>
        <div>${fmt.format(sub)}</div>
        <div><button data-i="${idx}" data-del="1">Ø­Ø°Ù</button></div></div>`;
      });
      html += `<div class="row foot"><div></div><div></div><div>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹</div><div>${fmt.format(total)}</div><div></div></div></div>`;
      document.getElementById('cart').innerHTML = html;
      document.querySelectorAll('button[data-a]').forEach(b=> b.onclick = e=>{
        const i = +e.target.dataset.i; const a = +e.target.dataset.a;
        const c = getCart(); c[i].qty = Math.max(1, c[i].qty + a); setCart(c); render();
      });
      document.querySelectorAll('button[data-del]').forEach(b=> b.onclick = e=>{
        const i = +e.target.dataset.i; const c = getCart(); c.splice(i,1); setCart(c); render();
      });
    }
    render();
    document.getElementById('place').onclick = () => {
      const cart = getCart();
      if(cart.length===0){ alert('Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ©'); return; }
      const name = document.getElementById('name').value.trim();
      const phone = document.getElementById('phone').value.trim();
      const address = document.getElementById('address').value.trim();
      const payment = document.getElementById('payment').value;
      if(!name || !phone || !address){ alert('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª'); return; }
      // Ù‡Ø°Ù‡ Ù‡ÙŠ Ø§Ù„Ù†Ù‚Ø·Ø© Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø© Ù„Ø±Ø¨Ø· API ÙØ¹Ù„ÙŠ Ù„Ù„Ø¯ÙØ¹/Ø§Ù„Ø·Ù„Ø¨Ø§Øª
      const order = {name, phone, address, payment, items: cart, createdAt: new Date().toISOString()};
      console.log('ORDER', order);
      localStorage.removeItem('cart');
      alert('ØªÙ… Ø§Ø³ØªÙ„Ø§Ù… Ø·Ù„Ø¨Ùƒ! Ø³ÙŠØªÙˆØ§ØµÙ„ Ù…Ø¹Ùƒ ÙØ±ÙŠÙ‚Ù†Ø§ Ù„Ù„ØªØ£ÙƒÙŠØ¯.');
      location.href = 'index.html';
    };
  </script>
</body>
</html>
